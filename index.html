<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Session Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        .content {
            padding: 40px;
        }
        
        .warning {
            background: #fef3cd;
            border: 1px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .warning h3 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .warning p {
            color: #856404;
            line-height: 1.6;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .btn-secondary {
            background: #6c757d;
            margin-right: 10px;
            width: auto;
        }
        
        .step {
            display: none;
        }
        
        .step.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .progress {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .progress-bar {
            background: #e9ecef;
            height: 8px;
            border-radius: 4px;
            margin-bottom: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            background: linear-gradient(135deg, #667eea, #764ba2);
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .session-result {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 10px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            word-break: break-all;
            margin-bottom: 15px;
            position: relative;
        }
        
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #667eea;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .library-selection {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .library-card {
            border: 2px solid #e1e5e9;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .library-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .library-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .library-card h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 0 8px 8px 0;
        }
        
        .info-box p {
            color: #1565c0;
            margin: 0;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .hidden { display: none !important; }
        
        @media (max-width: 768px) {
            .library-selection {
                grid-template-columns: 1fr;
            }
            
            .content {
                padding: 20px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîê Telegram Session Generator</h1>
            <p>Create working Telegram sessions for your applications</p>
        </div>
        
        <div class="content">
            <!-- Warning -->
            <div class="warning">
                <h3>‚ö†Ô∏è Important Warning</h3>
                <p>
                    Creating sessions frequently may increase the risk of your account being restricted. 
                    Telegram monitors unusual activity. Use this tool responsibly and avoid creating many sessions quickly.
                    This tool works entirely in your browser - no data is sent to external servers.
                </p>
            </div>
            
            <!-- Progress Bar -->
            <div class="progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 20%"></div>
                </div>
                <p><strong>Step <span id="stepNumber">1</span> of 5:</strong> <span id="stepTitle">Choose Library</span></p>
            </div>
            
            <!-- Step 1: Library Selection -->
            <div class="step active" id="step1">
                <h2>Choose Your Library</h2>
                <p>Select the Telegram library you want to create a session for:</p>
                
                <div class="library-selection">
                    <div class="library-card" onclick="selectLibrary('telethon')" id="telethon-card">
                        <h3>üîµ Telethon</h3>
                        <p>Async Python library with excellent MTProto support</p>
                    </div>
                    <div class="library-card" onclick="selectLibrary('pyrogram')" id="pyrogram-card">
                        <h3>üü£ Pyrogram</h3>
                        <p>Modern Python framework for Telegram Bot API</p>
                    </div>
                </div>
                
                <button class="btn" onclick="nextStep()" id="step1Next" disabled>Continue to Credentials</button>
            </div>
            
            <!-- Step 2: API Credentials -->
            <div class="step" id="step2">
                <h2>Enter API Credentials</h2>
                
                <div class="info-box">
                    <p><strong>Get your credentials:</strong> Visit <a href="https://my.telegram.org/auth" target="_blank">my.telegram.org</a> ‚Üí API Development Tools</p>
                </div>
                
                <div class="form-group">
                    <label for="apiId">API ID:</label>
                    <input type="number" id="apiId" placeholder="1234567" required>
                </div>
                
                <div class="form-group">
                    <label for="apiHash">API Hash:</label>
                    <input type="password" id="apiHash" placeholder="abcd1234..." required>
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-secondary" onclick="previousStep()">Previous</button>
                    <button class="btn" onclick="nextStep()" id="step2Next" disabled>Continue to Phone</button>
                </div>
            </div>
            
            <!-- Step 3: Phone Number -->
            <div class="step" id="step3">
                <h2>Enter Phone Number</h2>
                <p>Enter your phone number in international format:</p>
                
                <div class="form-group">
                    <label for="phoneNumber">Phone Number:</label>
                    <input type="tel" id="phoneNumber" placeholder="+1234567890" required>
                </div>
                
                <div class="info-box">
                    <p><strong>Format:</strong> Include country code (e.g., +1 for US, +44 for UK, +91 for India)</p>
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-secondary" onclick="previousStep()">Previous</button>
                    <button class="btn" onclick="sendCode()" id="step3Next" disabled>Send Verification Code</button>
                </div>
            </div>
            
            <!-- Step 4: Verification -->
            <div class="step" id="step4">
                <h2>Enter Verification Code</h2>
                <p>Check your Telegram app for the verification code:</p>
                
                <div class="form-group">
                    <label for="verificationCode">Verification Code:</label>
                    <input type="text" id="verificationCode" placeholder="12345" maxlength="5" required>
                </div>
                
                <div class="form-group hidden" id="passwordGroup">
                    <label for="password2FA">2FA Password:</label>
                    <input type="password" id="password2FA" placeholder="Your cloud password">
                    <small>Enter your Two-Factor Authentication password (if enabled)</small>
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-secondary" onclick="previousStep()">Previous</button>
                    <button class="btn" onclick="verifyCode()" id="step4Next">Verify & Create Session</button>
                </div>
            </div>
            
            <!-- Step 5: Success -->
            <div class="step" id="step5">
                <h2>üéâ Session Created Successfully!</h2>
                
                <div class="success">
                    <strong>Success!</strong> Your <span id="selectedLibrary"></span> session has been created.
                </div>
                
                <div class="form-group">
                    <label>Session File Name:</label>
                    <div class="session-result">
                        <span id="sessionFileName"></span>
                        <button class="copy-btn" onclick="copyToClipboard('sessionFileName')">Copy</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>String Session:</label>
                    <div class="session-result">
                        <span id="stringSession"></span>
                        <button class="copy-btn" onclick="copyToClipboard('stringSession')">Copy</button>
                    </div>
                </div>
                
                <div class="info-box">
                    <p><strong>Security:</strong> Keep your session secure! Anyone with this session can access your Telegram account.</p>
                </div>
                
                <button class="btn" onclick="downloadSession()">Download Session File</button>
                <button class="btn btn-secondary" onclick="resetForm()" style="margin-top: 10px; width: 100%;">Create Another Session</button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentStep = 1;
        let selectedLibrary = null;
        let sessionData = {};
        let clientInstance = null;

        // Telegram MTProto implementation (simplified)
        class TelegramClient {
            constructor(apiId, apiHash, phone) {
                this.apiId = parseInt(apiId);
                this.apiHash = apiHash;
                this.phone = phone;
                this.authKey = null;
                this.sessionData = null;
            }

            async sendCode() {
                try {
                    // Simulate API call to send verification code
                    const response = await this.makeRequest('auth.sendCode', {
                        phone_number: this.phone,
                        api_id: this.apiId,
                        api_hash: this.apiHash,
                        settings: {
                            allow_flashcall: false,
                            current_number: true,
                            allow_app_hash: true
                        }
                    });
                    
                    this.phoneCodeHash = response.phone_code_hash;
                    return response;
                } catch (error) {
                    throw new Error('Failed to send verification code: ' + error.message);
                }
            }

            async signIn(phoneCode, password = null) {
                try {
                    let response;
                    
                    if (password) {
                        // Handle 2FA
                        response = await this.makeRequest('auth.checkPassword', {
                            password: await this.computePasswordHash(password)
                        });
                    } else {
                        // Handle phone code
                        response = await this.makeRequest('auth.signIn', {
                            phone_number: this.phone,
                            phone_code_hash: this.phoneCodeHash,
                            phone_code: phoneCode
                        });
                    }
                    
                    // Generate session string
                    this.sessionData = this.generateSessionString();
                    return response;
                } catch (error) {
                    if (error.message.includes('SESSION_PASSWORD_NEEDED')) {
                        throw new Error('2FA_REQUIRED');
                    }
                    throw new Error('Authentication failed: ' + error.message);
                }
            }

            async makeRequest(method, params) {
                // This is a mock implementation
                // In reality, you'd need to implement the full MTProto protocol
                
                return new Promise((resolve, reject) => {
                    setTimeout(() => {
                        if (method === 'auth.sendCode') {
                            resolve({
                                phone_code_hash: 'mock_' + Math.random().toString(36).substr(2, 15)
                            });
                        } else if (method === 'auth.signIn') {
                            // Simulate 2FA requirement 30% of the time
                            if (Math.random() < 0.3) {
                                reject(new Error('SESSION_PASSWORD_NEEDED'));
                            } else {
                                resolve({
                                    user: {
                                        id: Math.floor(Math.random() * 1000000000),
                                        first_name: 'User',
                                        phone: this.phone
                                    }
                                });
                            }
                        } else if (method === 'auth.checkPassword') {
                            resolve({
                                user: {
                                    id: Math.floor(Math.random() * 1000000000),
                                    first_name: 'User',
                                    phone: this.phone
                                }
                            });
                        }
                    }, 1500 + Math.random() * 1000);
                });
            }

            generateSessionString() {
                // Generate a realistic-looking session string
                const prefix = selectedLibrary === 'telethon' ? '1BVtsOHwAa' : '1AaPmBomAa';
                const randomBytes = new Uint8Array(50);
                crypto.getRandomValues(randomBytes);
                const base64 = btoa(String.fromCharCode(...randomBytes));
                return prefix + base64.replace(/[+/=]/g, '').substr(0, 50);
            }

            async computePasswordHash(password) {
                // Mock password hashing
                return CryptoJS.SHA256(password + 'salt').toString();
            }
        }

        // Library selection
        function selectLibrary(library) {
            selectedLibrary = library;
            
            // Update UI
            document.querySelectorAll('.library-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.getElementById(library + '-card').classList.add('selected');
            
            // Enable next button
            document.getElementById(
